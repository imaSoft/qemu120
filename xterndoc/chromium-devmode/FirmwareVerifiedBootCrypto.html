<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<script async="" src="FirmwareVerifiedBootCrypto_files/cbgapi.loaded_0"></script><script src="FirmwareVerifiedBootCrypto_files/analytics.js" async=""></script><script type="text/javascript">/* Copyright 2008 Google. */ (function() { var b=window,e="tick",f="wtsrt_",g="tbsd_",h="tbnd_",k="start",m="_wtsrt",n="_tbnd";(function(){function l(a){this.t={};this.tick=function(a,c,d){this.t[a]=[void 0!=d?d:(new Date).getTime(),c]};this[e](k,null,a)}var a=new l;b.jstiming={Timer:l,load:a};if(b.performance&&b.performance.timing){var a=b.performance.timing,c=b.jstiming.load,d=a.navigationStart,a=a.responseStart;0<d&&a>=d&&(c[e](m,void 0,d),c[e](f,m,a),c[e](g,f))}try{a=null,b.chrome&&b.chrome.csi&&(a=Math.floor(b.chrome.csi().pageT),c&&0<d&&(c[e](n,void 0,b.chrome.csi().startE),c[e](h,n,d))),null==a&&b.gtbExternal&&(a=
b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,c&&0<d&&(c[e](n,void 0,b.external.startE),c[e](h,n,d))),a&&(b.jstiming.pt=a)}catch(p){}})(); })()
</script>
<link rel="shortcut icon" href="http://www.chromium.org/_/rsrc/1354323194313/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/229b45/system/app/images/apple-touch-icon.png" type="image/png">
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d=window,e="length",h="",k="__duration__",l="function";function m(c){return document.getElementById(c)}d.byId=m;function n(c){return c.replace(/^\s+|\s+$/g,h)}d.trim=n;var p=[],q=0;d.JOT_addListener=function(c,a,b){var f=new String(q++);c={eventName:c,handler:a,compId:b,key:f};p.push(c);return f};d.JOT_removeListenerByKey=function(c){for(var a=0;a<p[e];a++)if(p[a].key==c){p.splice(a,1);break}};d.JOT_removeAllListenersForName=function(c){for(var a=0;a<p[e];a++)p[a].eventName==c&&p.splice(a,1)};
d.JOT_postEvent=function(c,a,b){var f={eventName:c,eventSrc:a||{},payload:b||{}};if(d.JOT_fullyLoaded){a=p[e];for(b=0;b<a&&b<p[e];b++){var g=p[b];g&&g.eventName==c&&(f.listenerCompId=g.compId||h,(g=typeof g.handler==l?g.handler:d[g.handler])&&g(f))}}else d.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};d.JOT_delayedEvents=[];d.JOT_fullyLoaded=!1;
d.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var f=0;60<=b&&(b/=60,f=2);2<=b&&f++;return a?d.JOT_siteRelTimeStrs[f].replace(k,Math.floor(b)):d.JOT_userRelTimeStrs[f].replace(k,Math.floor(b))}; })()
</script>
<script>


var webspace = {"scottyUrl":"/_/upload","isConsumer":false,"canPublishScriptToAnyone":true,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"sharingUrlPrefix":"/_/sharing","csiReportUri":"http://csi.gstatic.com/csi","sharingPolicy":"OPENED_WITH_INDICATOR","analyticsAccountId":"UA-5484340-1","baseUri":"","name":"dev","domain":"chromium.org","features":{"asyncPermanentDelete":false,"folderEmbed":true,"docosHideNotificationSettings":true,"siteChromeInPlaceEditingProdLaunchPromo":true,"scottyForTrogImageUpload":false,"pdfEmbedSupport":false,"siteChromeSidebarWidgetsEditDialog":true,"canonicalLinkTagInHead":false,"siteChromeDialogsToolbar":true,"plusBadge":false,"siteChromeHorizontalNavigationDialog":true,"siteChromeSystemFooterDialog":true,"plusOneButtonOptions":true,"plusOneButton":true,"htmlEmbed":true,"siteChromeHeaderDialog":true,"siteChromeCustomFooterDialog":true,"colorsAndFontsRefactor":false,"photoAlbumsInOnePick":true},"adsensePublisherId":null,"gvizVersion":1,"siteTitle":"The Chromium Projects","pageSharingId":"jotspot_page","plusPageId":"","termsUrl":"http://www.google.com/a/help/intl/en/users/terms.html","enableAnalytics":true,"isPublic":true,"plusPageUrl":"","homePath":"/","sharingId":"jotspot","isAdsenseEnabled":true,"adsensePromoClickedOrSiteIneligible":true,"isStartPageEnabled":true,"domainAnalyticsAccountId":""};



webspace.gadgets = {"baseUri":"/system/app/pages/gadgets"};


webspace.user = {"uid":"","renderMobile":false,"primaryEmail":"guest","sessionIndex":"","namespaceUser":false,"displayNameOrEmail":"guest","namespace":"","hasAdminAccess":false,"guest_":true,"keyboardShortcuts":true,"domain":"","hasWriteAccess":false,"dasherUser":false,"userName":"guest"};

webspace.page = {"canDeleteWebspace":null,"locale":"en","state":"","wuid":"wuid:gx:4be194fd02a21c92","pageInheritsPermissions":null,"timeZone":"America/Los_Angeles","properties":{},"type":"text","canChangePath":true,"parentWuid":"wuid:gx:2eb69dd73ece341e","revision":5,"title":"Firmware Verified Boot Crypto Specification","isRtlLocale":false,"bidiEnabled":false,"siteLocale":"en","name":"verified-boot-crypto","path":"/chromium-os/chromiumos-design-docs/verified-boot-crypto","openMoreActionMenu":null,"isSiteRtlLocale":false,"parentPath":"/chromium-os/chromiumos-design-docs"};
webspace.page.breadcrumbs = [{"title":"Chromium OS","dir":"ltr","path":"/chromium-os","deleted":false},{"title":"Design Documents","dir":"ltr","path":"/chromium-os/chromiumos-design-docs","deleted":false},{"title":"Firmware Verified Boot Crypto Specification","dir":"ltr","path":"/chromium-os/chromiumos-design-docs/verified-boot-crypto","deleted":false}];


webspace.editorResources = {
  text: [
    'http://www.gstatic.com/sites/p/229b45/system/js/codemirror.js',
    'http://www.gstatic.com/sites/p/229b45/system/app/css/codemirror_css.css',
    'http://www.gstatic.com/sites/p/229b45/system/js/trog_edit__en.js',
    'http://www.gstatic.com/sites/p/229b45/system/app/css/trogedit.css',
    '/_/rsrc/1364510364000/system/app/css/editor.css',
    'http://www.gstatic.com/sites/p/229b45/system/app/css/codeeditor.css',
    '/_/rsrc/1364510364000/system/app/css/camelot/editor-jfk.css'
  ],
  sitelayout: [
    'http://www.gstatic.com/sites/p/229b45/system/app/css/sitelayouteditor.css'
  ]
};

var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/229b45/system/app/images/cleardot.gif';


var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];


webspace.siteTemplateId = false;


webspace.page.currentTemplate = {"title":"Web Page","path":"/system/app/pagetemplates/text"};



var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Firmware Verified Boot Crypto Specification - The Chromium Projects">
<meta itemprop="name" content="Firmware Verified Boot Crypto Specification - The Chromium Projects">
<meta property="og:title" content="Firmware Verified Boot Crypto Specification - The Chromium Projects">
<meta name="description" content="Home of the Chromium Open Source Project">
<meta itemprop="description" content="Home of the Chromium Open Source Project">
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project">
<meta itemprop="image" content="/_/rsrc/1302286216006/config/customLogo.gif?revision=2">
<meta property="og:image" content="/_/rsrc/1302286216006/config/customLogo.gif?revision=2">
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="FirmwareVerifiedBootCrypto_files/standard-css-beigeandblue-ltr-ltr.css">
<link rel="stylesheet" type="text/css" href="FirmwareVerifiedBootCrypto_files/overlay.css">
<link rel="stylesheet" type="text/css" href="FirmwareVerifiedBootCrypto_files/symbolfont.css">
<link rel="stylesheet" type="text/css" href="FirmwareVerifiedBootCrypto_files/allthemes-view.css">
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Firmware Verified Boot Crypto Specification - The Chromium Projects</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
<script src="FirmwareVerifiedBootCrypto_files/js" charset="UTF-8" type="text/javascript"></script><link href="http://www.chromium.org/chromium-os/chromiumos-design-docs/verified-boot-crypto" rel="canonical"><style>.dcs-n-dcs-mf-dcs-nf{position:relative;display:-moz-inline-box;display:inline-block}* html .dcs-n-dcs-mf-dcs-nf{display:inline}*:first-child+html .dcs-n-dcs-mf-dcs-nf{display:inline}.dcs-i-dcs-tb{-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;cursor:default;font-size:11px;font-weight:bold;text-align:center;white-space:nowrap;margin-right:16px;height:27px;line-height:27px;min-width:54px;outline:0px;padding:0 8px}.dcs-i-dcs-tb-dcs-dg{-webkit-box-shadow:0 1px 1px rgba(0,0,0,.1);-moz-box-shadow:0 1px 1px rgba(0,0,0,.1);box-shadow:0 1px 1px rgba(0,0,0,.1)}.dcs-i-dcs-tb-dcs-wd{-webkit-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);-moz-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1)}.dcs-i-dcs-tb .dcs-i-dcs-tb-dcs-he{margin-top:-3px;vertical-align:middle}.dcs-i-dcs-tb-dcs-ef{margin-left:5px}.dcs-i-dcs-tb-dcs-jc{min-width:34px;padding:0}.dcs-i-dcs-tb-dcs-kc-dcs-lc,.dcs-i-dcs-tb-dcs-kc-dcs-df{z-index:1}.dcs-i-dcs-tb-dcs-kc-dcs-lc.dcs-i-dcs-tb-dcs-nd{z-index:0}.dcs-i-dcs-tb-dcs-sc.dcs-i-dcs-tb-dcs-kc-dcs-lc,.dcs-i-dcs-tb-dcs-sc.dcs-i-dcs-tb-dcs-kc-dcs-df{z-index:2}.dcs-i-dcs-tb-dcs-kc-dcs-lc:focus,.dcs-i-dcs-tb-dcs-kc-dcs-df:focus,.dcs-i-dcs-tb-dcs-dg.dcs-i-dcs-tb-dcs-kc-dcs-lc,.dcs-i-dcs-tb-dcs-dg.dcs-i-dcs-tb-dcs-kc-dcs-df{z-index:3}.dcs-i-dcs-tb-dcs-kc-dcs-lc{margin-left:-1px;-moz-border-radius-bottomleft:0;-moz-border-radius-topleft:0;-webkit-border-bottom-left-radius:0;-webkit-border-top-left-radius:0;border-bottom-left-radius:0;border-top-left-radius:0}.dcs-i-dcs-tb-dcs-kc-dcs-df{margin-right:0px;-moz-border-radius-topright:0;-moz-border-radius-bottomright:0;-webkit-border-top-right-radius:0;-webkit-border-bottom-right-radius:0;border-top-right-radius:0;border-bottom-right-radius:0}.dcs-i-dcs-tb.dcs-i-dcs-tb-dcs-nd:active{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}.dcs-i-dcs-tb-dcs-ub{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;background-color:#4d90fe;background-image:-webkit-linear-gradient(top,#4d90fe,#4787ed);background-image:-moz-linear-gradient(top,#4d90fe,#4787ed);background-image:-ms-linear-gradient(top,#4d90fe,#4787ed);background-image:-o-linear-gradient(top,#4d90fe,#4787ed);background-image:linear-gradient(top,#4d90fe,#4787ed);border:1px solid #3079ed;color:#fff}.dcs-i-dcs-tb-dcs-ub.dcs-i-dcs-tb-dcs-dg{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;background-color:#357ae8;background-image:-webkit-linear-gradient(top,#4d90fe,#357ae8);background-image:-moz-linear-gradient(top,#4d90fe,#357ae8);background-image:-ms-linear-gradient(top,#4d90fe,#357ae8);background-image:-o-linear-gradient(top,#4d90fe,#357ae8);background-image:linear-gradient(top,#4d90fe,#357ae8);border:1px solid #2f5bb7;border-bottom-color:#2f5bb7}.dcs-i-dcs-tb-dcs-ub:focus{-webkit-box-shadow:inset 0 0 0 1px #fff;-moz-box-shadow:inset 0 0 0 1px #fff;box-shadow:inset 0 0 0 1px #fff;border:1px solid #fff;border:1px solid rgba(0,0,0,0);outline:1px solid #4d90fe;outline:0 rgba(0,0,0,0)}.dcs-i-dcs-tb-dcs-ub.dcs-i-dcs-tb-dcs-qe-dcs-re{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;outline:none}.dcs-i-dcs-tb-dcs-ub:active{-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);-moz-box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);background:#357ae8;border:1px solid #2f5bb7;border-top:1px solid #2f5bb7}.dcs-i-dcs-tb-dcs-ub.dcs-i-dcs-tb-dcs-nd{background:#4d90fe;filter:alpha(opacity=50);opacity:0.5}.dcs-i-dcs-tb-dcs-pd{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;background-color:#f5f5f5;background-image:-webkit-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-moz-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-ms-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-o-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:linear-gradient(top,#f5f5f5,#f1f1f1);color:#444;border:1px solid #dcdcdc;border:1px solid rgba(0,0,0,0.1)}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-dg,.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-qe-dcs-re.dcs-i-dcs-tb-dcs-dg{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;background-color:#f8f8f8;background-image:-webkit-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-moz-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-ms-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-o-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:linear-gradient(top,#f8f8f8,#f1f1f1);border:1px solid #c6c6c6;color:#333}.dcs-i-dcs-tb-dcs-pd:active,.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-dg:active{-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);-moz-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1);background:#f8f8f8}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-wd,.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-qe-dcs-re.dcs-i-dcs-tb-dcs-wd{background-color:#eee;background-image:-webkit-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-moz-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-ms-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-o-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:linear-gradient(top,#f8f8f8,#f1f1f1);border:1px solid #ccc;color:#333}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-sc,.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-qe-dcs-re.dcs-i-dcs-tb-dcs-sc{-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);-moz-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1);background-color:#eee;background-image:-webkit-linear-gradient(top,#eee,#e0e0e0);background-image:-moz-linear-gradient(top,#eee,#e0e0e0);background-image:-ms-linear-gradient(top,#eee,#e0e0e0);background-image:-o-linear-gradient(top,#eee,#e0e0e0);background-image:linear-gradient(top,#eee,#e0e0e0);border:1px solid #ccc;color:#333}.dcs-i-dcs-tb-dcs-pd:focus{border:1px solid #4d90fe;outline:none}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-qe-dcs-re{border:1px solid #dcdcdc;outline:none}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-nd{background:#fff;border:1px solid #f3f3f3;border:1px solid rgba(0,0,0,0.05);color:#b8b8b8}.dcs-i-dcs-tb-dcs-pd .dcs-i-dcs-tb-dcs-he{opacity:.55}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-sc .dcs-i-dcs-tb-dcs-he,.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-wd .dcs-i-dcs-tb-dcs-he,.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-dg .dcs-i-dcs-tb-dcs-he{opacity:0.9}.dcs-i-dcs-tb-dcs-pd.dcs-i-dcs-tb-dcs-nd .dcs-i-dcs-tb-dcs-he{filter:alpha(opacity=33);opacity:0.333}.dcs-n-dcs-rf,.dcs-bd-dcs-cd{-webkit-box-shadow:0 4px 16px rgba(0,0,0,.2);-moz-box-shadow:0 4px 16px rgba(0,0,0,.2);box-shadow:0 4px 16px rgba(0,0,0,.2);background:#fff;background-clip:padding-box;border:1px solid #acacac;border:1px solid rgba(0,0,0,.333);outline:0;position:absolute}.dcs-n-dcs-rf-dcs-ad,.dcs-bd-dcs-cd-dcs-ad{background:#fff;left:0;position:absolute;top:0}div.dcs-n-dcs-rf-dcs-ad,div.dcs-bd-dcs-cd-dcs-ad{filter:alpha(opacity=75);-moz-opacity:.75;opacity:.75}.dcs-bd-dcs-cd{color:#000;padding:30px 42px}.dcs-bd-dcs-cd-dcs-zd{background-color:#fff;color:#000;cursor:default;font-size:16px;font-weight:normal;line-height:24px;margin:0 0 16px}.dcs-bd-dcs-cd-dcs-zd-dcs-af{height:11px;opacity:0.7;padding:17px;position:absolute;right:0px;top:0px;width:11px}.dcs-bd-dcs-cd-dcs-zd-dcs-af:after{content:'';background:url(//ssl.gstatic.com/ui/v1/dialog/close-x.png);position:absolute;height:11px;width:11px;right:17px}.dcs-bd-dcs-cd-dcs-zd-dcs-af:hover{opacity:1}.dcs-bd-dcs-cd-dcs-t{background-color:#fff;line-height:1.4em}.dcs-bd-dcs-cd-dcs-gc{margin-top:16px}.dcs-bd-dcs-cd-dcs-gc button{-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;background-color:#f5f5f5;background-image:-webkit-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-moz-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-ms-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:-o-linear-gradient(top,#f5f5f5,#f1f1f1);background-image:linear-gradient(top,#f5f5f5,#f1f1f1);border:1px solid #dcdcdc;border:1px solid rgba(0,0,0,0.1);color:#444;cursor:default;font-size:11px;font-weight:bold;height:29px;line-height:27px;margin:0 16px 0 0;min-width:72px;outline:0;padding:0 8px}.dcs-bd-dcs-cd-dcs-gc button:hover,.dcs-bd-dcs-cd-dcs-gc button:active{-webkit-box-shadow:0px 1px 1px rgba(0,0,0,0.1);-moz-box-shadow:0px 1px 1px rgba(0,0,0,0.1);box-shadow:0px 1px 1px rgba(0,0,0,0.1);background-color:#f8f8f8;background-image:-webkit-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-moz-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-ms-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:-o-linear-gradient(top,#f8f8f8,#f1f1f1);background-image:linear-gradient(top,#f8f8f8,#f1f1f1);border:1px solid #c6c6c6;color:#333}.dcs-bd-dcs-cd-dcs-gc button:active{-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);-moz-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1)}.dcs-bd-dcs-cd-dcs-gc button:focus{border:1px solid #4d90fe}.dcs-bd-dcs-cd-dcs-gc button[disabled]{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;background:#fff;background-image:none;border:1px solid #f3f3f3;border:1px solid rgba(0,0,0,0.05);color:#b8b8b8}.dcs-bd-dcs-cd-dcs-gc .dcs-n-dcs-vd-dcs-ub{background-color:#4d90fe;background-image:-webkit-linear-gradient(top,#4d90fe,#4787ed);background-image:-moz-linear-gradient(top,#4d90fe,#4787ed);background-image:-ms-linear-gradient(top,#4d90fe,#4787ed);background-image:-o-linear-gradient(top,#4d90fe,#4787ed);background-image:linear-gradient(top,#4d90fe,#4787ed);border:1px solid #3079ed;color:#fff}.dcs-bd-dcs-cd-dcs-gc .dcs-n-dcs-vd-dcs-ub:hover,.dcs-bd-dcs-cd-dcs-gc .dcs-n-dcs-vd-dcs-ub:active{background-color:#357ae8;background-image:-webkit-linear-gradient(top,#4d90fe,#357ae8);background-image:-moz-linear-gradient(top,#4d90fe,#357ae8);background-image:-ms-linear-gradient(top,#4d90fe,#357ae8);background-image:-o-linear-gradient(top,#4d90fe,#357ae8);background-image:linear-gradient(top,#4d90fe,#357ae8);border:1px solid #2f5bb7;color:#fff}.dcs-bd-dcs-cd-dcs-gc .dcs-n-dcs-vd-dcs-ub:active{-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);-moz-box-shadow:inset 0 1px 2px rgba(0,0,0,0.3);box-shadow:inset 0 1px 2px rgba(0,0,0,0.3)}.dcs-bd-dcs-cd-dcs-gc .dcs-n-dcs-vd-dcs-ub:focus{-webkit-box-shadow:inset 0 0 0 1px #fff;-moz-box-shadow:inset 0 0 0 1px #fff;box-shadow:inset 0 0 0 1px #fff;border:1px solid #fff;border:1px solid rgba(0,0,0,0);outline:1px solid #4d90fe;outline:0 rgba(0,0,0,0)}.dcs-bd-dcs-cd-dcs-gc .dcs-n-dcs-vd-dcs-ub[disabled]{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;background:#4d90fe;color:#fff;filter:alpha(opacity=50);opacity:0.5}.dcs-i-dcs-lf,.dcs-i-dcs-yc,.dcs-i-dcs-j{width:512px}.dcs-n-dcs-oe{-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-box-shadow:0 2px 4px rgba(0,0,0,0.2);-moz-box-shadow:0 2px 4px rgba(0,0,0,0.2);box-shadow:0 2px 4px rgba(0,0,0,0.2);-webkit-transition:opacity 0.218s;-moz-transition:opacity 0.218s;-o-transition:opacity 0.218s;transition:opacity 0.218s;background:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,.2);cursor:default;font-size:13px;margin:0;outline:none;padding:6px 0;position:absolute}.dcs-n-dcs-o,.dcs-n-dcs-fg,.dcs-n-dcs-gg{position:relative;color:#333;cursor:pointer;list-style:none;margin:0;padding:6px 8em 6px 30px;white-space:nowrap}.dcs-n-dcs-oe-dcs-hg .dcs-n-dcs-o,.dcs-n-dcs-oe-dcs-ig .dcs-n-dcs-o{padding-left:16px;vertical-align:middle}.dcs-n-dcs-oe-dcs-jg .dcs-n-dcs-o{padding-right:44px}.dcs-n-dcs-o-dcs-nd{cursor:default}.dcs-n-dcs-o-dcs-nd .dcs-n-dcs-o-dcs-cc,.dcs-n-dcs-o-dcs-nd .dcs-n-dcs-o-dcs-t{color:#ccc!important}.dcs-n-dcs-o-dcs-nd .dcs-n-dcs-o-dcs-cb{filter:alpha(opacity=30);opacity:0.3}.dcs-n-dcs-o-dcs-ie,.dcs-n-dcs-o-dcs-dg{background-color:#eee;border-color:#eee;border-style:dotted;border-width:1px 0;padding-top:5px;padding-bottom:5px}.dcs-n-dcs-o-dcs-ie .dcs-n-dcs-o-dcs-t,.dcs-n-dcs-o-dcs-dg .dcs-n-dcs-o-dcs-t{color:#333}.dcs-n-dcs-o-dcs-ee,.dcs-n-dcs-o-dcs-cb{background-repeat:no-repeat;height:21px;left:3px;position:absolute;right:auto;top:3px;vertical-align:middle;width:21px}.dcs-n-dcs-rd-dcs-wd{background-image:url(//ssl.gstatic.com/ui/v1/menu/checkmark.png);background-repeat:no-repeat;background-position:left center}.dcs-n-dcs-rd-dcs-wd .dcs-n-dcs-o-dcs-t,.dcs-n-dcs-rd-dcs-wd .dcs-n-dcs-o-dcs-t{color:#333}.dcs-n-dcs-o-dcs-cc{color:#777;direction:ltr;left:auto;padding:0 6px;position:absolute;right:0;text-align:right}.dcs-n-dcs-o-dcs-dd-dcs-kg{text-decoration:underline}.dcs-n-dcs-o-dcs-dd-dcs-ed{color:#777;font-size:12px;padding-left:4px}.dcs-i-dcs-tf::-webkit-scrollbar{height:16px;overflow:visible;width:16px}.dcs-i-dcs-tf::-webkit-scrollbar-button{height:0;width:0}.dcs-i-dcs-tf::-webkit-scrollbar-track{background-clip:padding-box;border:solid transparent;border-width:0 0 0 4px}.dcs-i-dcs-tf::-webkit-scrollbar-track:horizontal{border-width:4px 0 0}.dcs-i-dcs-tf::-webkit-scrollbar-track:hover{background-color:rgba(0,0,0,.05);box-shadow:inset 1px 0 0 rgba(0,0,0,.1)}.dcs-i-dcs-tf::-webkit-scrollbar-track:horizontal:hover{box-shadow:inset 0 1px 0 rgba(0,0,0,.1)}.dcs-i-dcs-tf::-webkit-scrollbar-track:active{background-color:rgba(0,0,0,.05);box-shadow:inset 1px 0 0 rgba(0,0,0,.14),inset -1px 0 0 rgba(0,0,0,.07)}.dcs-i-dcs-tf::-webkit-scrollbar-track:horizontal:active{box-shadow:inset 0 1px 0 rgba(0,0,0,.14),inset 0 -1px 0 rgba(0,0,0,.07)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-track:hover{background-color:rgba(255,255,255,.1);box-shadow:inset 1px 0 0 rgba(255,255,255,.2)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-track:horizontal:hover{box-shadow:inset 0 1px 0 rgba(255,255,255,.2)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-track:active{background-color:rgba(255,255,255,.1);box-shadow:inset 1px 0 0 rgba(255,255,255,.25),inset -1px 0 0 rgba(255,255,255,.15)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-track:horizontal:active{box-shadow:inset 0 1px 0 rgba(255,255,255,.25),inset 0 -1px 0 rgba(255,255,255,.15)}.dcs-i-dcs-tf::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,.2);background-clip:padding-box;border:solid transparent;border-width:1px 1px 1px 6px;min-height:28px;padding:100px 0 0;box-shadow:inset 1px 1px 0 rgba(0,0,0,.1),inset 0 -1px 0 rgba(0,0,0,.07)}.dcs-i-dcs-tf::-webkit-scrollbar-thumb:horizontal{border-width:6px 1px 1px;padding:0 0 0 100px;box-shadow:inset 1px 1px 0 rgba(0,0,0,.1),inset -1px 0 0 rgba(0,0,0,.07)}.dcs-i-dcs-tf::-webkit-scrollbar-thumb:hover{background-color:rgba(0,0,0,.4);box-shadow:inset 1px 1px 1px rgba(0,0,0,.25)}.dcs-i-dcs-tf::-webkit-scrollbar-thumb:active{background-color:rgba(0,0,0,0.5);box-shadow:inset 1px 1px 3px rgba(0,0,0,0.35)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-thumb{background-color:rgba(255,255,255,.3);box-shadow:inset 1px 1px 0 rgba(255,255,255,.15),inset 0 -1px 0 rgba(255,255,255,.1)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-thumb:horizontal{box-shadow:inset 1px 1px 0 rgba(255,255,255,.15),inset -1px 0 0 rgba(255,255,255,.1)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-thumb:hover{background-color:rgba(255,255,255,.6);box-shadow:inset 1px 1px 1px rgba(255,255,255,.37)}.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-thumb:active{background-color:rgba(255,255,255,.75);box-shadow:inset 1px 1px 3px rgba(255,255,255,.5)}.dcs-i-dcs-tf-dcs-mg.dcs-i-dcs-tf::-webkit-scrollbar-track{border-width:0 1px 0 6px}.dcs-i-dcs-tf-dcs-mg.dcs-i-dcs-tf::-webkit-scrollbar-track:horizontal{border-width:6px 0 1px}.dcs-i-dcs-tf-dcs-mg.dcs-i-dcs-tf::-webkit-scrollbar-track:hover{background-color:rgba(0,0,0,.035);box-shadow:inset 1px 1px 0 rgba(0,0,0,.14),inset -1px -1px 0 rgba(0,0,0,.07)}.dcs-i-dcs-tf-dcs-mg.dcs-i-dcs-tf-dcs-lg.dcs-i-dcs-tf::-webkit-scrollbar-track:hover{background-color:rgba(255,255,255,.07);box-shadow:inset 1px 1px 0 rgba(255,255,255,.25),inset -1px -1px 0 rgba(255,255,255,.15)}.dcs-i-dcs-tf-dcs-mg.dcs-i-dcs-tf::-webkit-scrollbar-thumb{border-width:0 1px 0 6px}.dcs-i-dcs-tf-dcs-mg.dcs-i-dcs-tf::-webkit-scrollbar-thumb:horizontal{border-width:6px 0 1px}.dcs-i-dcs-tf::-webkit-scrollbar-corner{background:transparent}body.dcs-i-dcs-tf::-webkit-scrollbar-track-piece{background-clip:padding-box;background-color:#f5f5f5;border:solid #fff;border-width:0 0 0 3px;box-shadow:inset 1px 0 0 rgba(0,0,0,.14),inset -1px 0 0 rgba(0,0,0,.07)}body.dcs-i-dcs-tf::-webkit-scrollbar-track-piece:horizontal{border-width:3px 0 0;box-shadow:inset 0 1px 0 rgba(0,0,0,.14),inset 0 -1px 0 rgba(0,0,0,.07)}body.dcs-i-dcs-tf::-webkit-scrollbar-thumb{border-width:1px 1px 1px 5px}body.dcs-i-dcs-tf::-webkit-scrollbar-thumb:horizontal{border-width:5px 1px 1px}body.dcs-i-dcs-tf::-webkit-scrollbar-corner{background-clip:padding-box;background-color:#f5f5f5;border:solid #fff;border-width:3px 0 0 3px;box-shadow:inset 1px 1px 0 rgba(0,0,0,.14)}.dcs-bd-dcs-cd{z-index:1001}.dcs-bd-dcs-cd-dcs-ad{z-index:1000}.dcs-bd-dcs-cd-dcs-zd-dcs-af{background-image:none}.dcs-n-dcs-oe{z-index:1001}.dcs-a-dcs-dc-dcs-mb{width:12px;height:12px;vertical-align:baseline}.dcs-a-dcs-dc-dcs-eb{background:none;background-image:none!important;border:none;font-size:10px;height:11px;left:0;margin:auto;position:absolute;top:3px;width:12px}.dcs-a-dcs-dc-dcs-eb-dcs-q-dcs-u,.dcs-a-dcs-dc-dcs-eb-dcs-mb-dcs-u{border:none!important;height:11px;margin:0;padding:0;width:12px}.dcs-a-dcs-dc{padding:3px}.dcs-a-dcs-dc>.dcs-n-dcs-o{padding:3px}.dcs-a-dcs-dc>.dcs-n-dcs-o.dcs-n-dcs-rd-dcs-wd{padding-left:22px}.dcs-a-dcs-dc>.dcs-n-dcs-o-dcs-ie,.dcs-a-dcs-dc>.dcs-n-dcs-o-dcs-dg{padding:2px 3px}.dcs-a-dcs-dc>.dcs-n-dcs-o>.dcs-n-dcs-o-dcs-t{font-size:12px}.dcs-a-dcs-b{background-color:#fff;cursor:pointer;direction:ltr;position:relative;width:210px}.dcs-a-dcs-b:hover,.dcs-a-dcs-vb-dcs-xd.dcs-a-dcs-b{background-color:#f1f1f1!important;border-color:#c6c6c6!important;background:-webkit-gradient(linear,0 0,0 60,from(#f8f8f8),to(#f1f1f1))!important;background:-moz-linear-gradient(top,#f8f8f8 0,#f1f1f1 60px)!important}.dcs-a-dcs-b:focus,.dcs-a-dcs-b:active{outline:0}.dcs-a-dcs-b-dcs-de-dcs-q,.dcs-a-dcs-b-dcs-de-dcs-mb{display:none}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b,.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b:hover{background:#fcfac6!important;border-color:#ffe572!important}.dcs-a-dcs-b-dcs-rb-dcs-tb{display:none;font-size:10px;right:0;padding-left:2px;position:absolute;top:0}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b .dcs-a-dcs-b-dcs-rb-dcs-tb{display:block;opacity:0.3;filter:alpha(opacity=30)}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b:hover .dcs-a-dcs-b-dcs-rb-dcs-tb{opacity:1;filter:alpha(opacity=100)}.dcs-a-dcs-b-dcs-sf{max-height:inherit;overflow-y:auto}.dcs-a-dcs-b-dcs-t{overflow-y:auto}.dcs-a-dcs-b-dcs-c-dcs-d{border-top:1px solid #f0f0f0;display:none;padding:7px}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b .dcs-a-dcs-b-dcs-c-dcs-d{border-top:1px solid #feef9c;display:block}.dcs-a-dcs-b-dcs-c-dcs-d .dcs-a-dcs-c-dcs-id{height:23px}.dcs-a-dcs-b-dcs-c-dcs-d .dcs-a-dcs-c-dcs-gc{text-align:left}.dcs-a-dcs-xe-dcs-c-dcs-d{border-top:none!important;padding-top:0}.dcs-a-dcs-b .dcs-a-dcs-c-dcs-ob-dcs-pb-dcs-qb{color:#999;font-size:11px}.dcs-a-dcs-b .dcs-a-dcs-b-dcs-lb{border-top:1px solid #feef9c;bottom:0;left:0;padding-top:6px;position:relative;width:100%}.dcs-a-dcs-b .dcs-a-dcs-lb-dcs-yd{font-weight:bold;margin-right:6px;padding:2px 0}.dcs-a-dcs-e-dcs-zf .dcs-a-dcs-b{border:1px solid #d9d9d9;position:absolute;-moz-user-select:text;z-index:500}.dcs-a-dcs-e-dcs-zf .dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b{border:1px solid #ffe764;z-index:501}.dcs-a-dcs-e-dcs-zf-dcs-cg .dcs-a-dcs-b{box-shadow:2px 2px 6px #888}.dcs-a-dcs-e-dcs-f .dcs-a-dcs-b-dcs-de-dcs-q,.dcs-a-dcs-b-dcs-de-dcs-mb{height:0;position:absolute;width:0}.dcs-a-dcs-e-dcs-f .dcs-a-dcs-b-dcs-de-dcs-q{border-top:none;border-bottom:14px solid transparent;border-left:none;border-right:14px solid #fcfac6;left:-13px;top:0}.dcs-a-dcs-e-dcs-f .dcs-a-dcs-b-dcs-de-dcs-mb{border-top:none;border-bottom:14px solid transparent;border-left:none;border-right:14px solid #ffe572;left:-15px;top:-1px}.dcs-a-dcs-e-dcs-f .dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b>.dcs-a-dcs-b-dcs-de-dcs-q,.dcs-a-dcs-e-dcs-f .dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b>.dcs-a-dcs-b-dcs-de-dcs-mb{display:block}.dcs-a-dcs-b-dcs-rb-dcs-tb>.dcs-i-dcs-tb{height:17px;line-height:17px;margin:2px 2px 0 0}.dcs-a-dcs-ab,.dcs-a-dcs-wb{border-top:1px solid #f0f0f0;padding:7px;position:relative;zoom:1}.dcs-a-dcs-ab-dcs-k{left:7px!important}.dcs-a-dcs-ab.dcs-a-dcs-jb-dcs-we{border-top:none!important}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b .dcs-a-dcs-ab,.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b .dcs-a-dcs-wb{border-top:1px solid #feef9c}.dcs-a-dcs-ab-dcs-ac{font-weight:bold;margin-left:32px}.dcs-a-dcs-ab-dcs-bb{word-wrap:break-word;color:#666;padding-top:3px;padding-bottom:3px}.dcs-a-dcs-ab-dcs-hd{color:#666;font-size:10px;margin:3px 0 0 32px}.dcs-a-dcs-ab .dcs-a-dcs-jb-dcs-sb{display:none}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-b .dcs-a-dcs-jb-dcs-sb,.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-wb .dcs-a-dcs-jb-dcs-sb{display:block}.dcs-a-dcs-wb-dcs-xb{word-wrap:break-word;color:#15c}.dcs-a-dcs-wb-dcs-xb:hover,.dcs-a-dcs-b:hover .dcs-a-dcs-wb-dcs-xb{text-decoration:underline}.dcs-a-dcs-zb-dcs-jb{position:relative}.dcs-a-dcs-xb-dcs-jb{height:150px;overflow:hidden}.dcs-a-dcs-gb-dcs-ge,.dcs-a-dcs-gb-dcs-ag{color:#15c;display:none;opacity:1;width:100%}.dcs-a-dcs-gb-dcs-ge{bottom:0;padding-top:16px;position:absolute;right:0}.dcs-a-dcs-gb-dcs-ag{background:#fff;padding:2px 0}.dcs-a-dcs-gb-dcs-ge:hover,.dcs-a-dcs-gb-dcs-ag:hover{text-decoration:underline}.dcs-a-dcs-b.dcs-a-dcs-vb:hover .dcs-a-dcs-gb-dcs-ge{background:#f1f1f1;background:-webkit-gradient(linear,0 0,0 16,from(rgba(241,241,241,0)),to(rgba(241,241,241,1)));background:-moz-linear-gradient(top,rgba(241,241,241,0),#f1f1f1 16px);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0, FinishOpacity=100, Style=1, StartY=0, FinishY=50, StartX=0, FinishX=0)";filter:alpha(Opacity=0,FinishOpacity=100,Style=1,StartY=0,FinishY=50,StartX=0,FinishX=0)}.dcs-a-dcs-b.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-gb-dcs-ge,.dcs-a-dcs-b.dcs-a-dcs-vb-dcs-jd:hover .dcs-a-dcs-gb-dcs-ge{background:#fcfac6;background:-webkit-gradient(linear,0 0,0 16,from(rgba(252,250,198,0)),to(rgba(252,250,198,1)));background:-moz-linear-gradient(top,rgba(252,250,198,0),#fcfac6 16px);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0, FinishOpacity=100, StartY=0, FinishY=50, Style=1, StartX=0, FinishX=0)";filter:alpha(Opacity=0,FinishOpacity=100,Style=1,StartY=0,FinishY=50,StartX=0,FinishX=0)}.dcs-a-dcs-gb-dcs-ge{background:#fff;background:-webkit-gradient(linear,0 0,0 16,from(rgba(255,255,255,0)),to(rgba(255,255,255,1)));background:-moz-linear-gradient(top,rgba(255,255,255,0),#fff 16px);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0, FinishOpacity=100, StartY=0, FinishY=50, Style=1, StartX=0, FinishX=0)";filter:alpha(Opacity=0,FinishOpacity=100,Style=1,StartY=0,FinishY=50,StartX=0,FinishX=0)}.dcs-a-dcs-xb-dcs-jb>.dcs-a-dcs-gb-dcs-ge{display:block!important}.dcs-a-dcs-b.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-gb-dcs-ag{background:#fcfac6!important}.dcs-a-dcs-b:hover .dcs-a-dcs-gb-dcs-ag{background:#f1f1f1}.dcs-a-dcs-l{background:#e0ecff;border:1px solid #666;color:#00c;font-family:Arial;margin:0px 0px;padding:0px 0px 1px 0px;position:absolute;z-index:900}.dcs-a-dcs-l div{cursor:pointer;margin:2px;padding:0px 10px}.dcs-a-dcs-l div b{color:#00f}.dcs-a-dcs-l .dcs-l-dcs-m{height:auto}.dcs-a-dcs-l div.dcs-jd{background:#c3d9ff}.dcs-a-dcs-k{left:0;position:absolute}.dcs-a-dcs-bf-dcs-cf{font:10px/12px Arial;color:#bbb;text-align:right;padding-right:30px}.dcs-a-dcs-bf-dcs-cf a{color:#bbb}.dcs-a-dcs-ec-dcs-fc{width:620px}.dcs-a{color:black;font-family:Arial,sans-serif,sans;font-size:13px;white-space:normal}.dcs-a-dcs-cb{background-image:url(//ssl.gstatic.com/docs/common/d-icons10.png);background-repeat:no-repeat}.dcs-a-dcs-cb-dcs-rb-dcs-wc{background-position:-28px -26;height:37px;position:absolute;width:37px}.dcs-a-dcs-cb-dcs-rb-dcs-wc-dcs-xc{background-position:0 -36px;height:27px;position:absolute;width:27px}.dcs-a-dcs-cb-dcs-db-dcs-eb{background-position:0 -11px;height:11px;width:12px}.dcs-a-dcs-cb-dcs-db-dcs-eb:hover,.dcs-n-dcs-oe-dcs-tb-dcs-ke .dcs-a-dcs-cb-dcs-db-dcs-eb{background-position:0 0;height:11px;width:12px}.dcs-a-dcs-c{position:relative;zoom:1}.dcs-a-dcs-c.dcs-a-dcs-c-dcs-hc{display:block!important}.dcs-a-dcs-c-dcs-p-dcs-q{border-top:7px solid transparent;border-right:8px solid #fff;border-bottom:7px solid transparent;height:0;left:-6px;position:absolute;top:3px}.dcs-a-dcs-c-dcs-p-dcs-mb{border-top:7px solid transparent;border-right:8px solid #c8c8c8;border-bottom:7px solid transparent;height:0;left:-7px;position:absolute;top:3px}.dcs-a-dcs-c-dcs-id{border:1px solid #c8c8c8;box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-webkit-box-sizing:border-box;color:#999;font-family:Arial,sans-serif;font-size:13px;margin:0;overflow-x:hidden;overflow-y:hidden;outline-width:0!important;padding:4px;resize:none;width:100%}.dcs-a-dcs-c-dcs-id:disabled{background-color:#eee!important}*:first-child+html .dcs-a-dcs-c-dcs-id{width:95%}.dcs-a-dcs-c-dcs-gc{display:none;zoom:1}.dcs-a-dcs-c-dcs-gc-dcs-se{font-weight:bold}.dcs-a-dcs-c-dcs-mc>.dcs-a-dcs-c-dcs-id{color:#000}.dcs-a-dcs-c-dcs-mc>.dcs-a-dcs-c-dcs-gc{display:block}.dcs-a-dcs-ld-dcs-t{width:500px}.dcs-a-dcs-ld-dcs-ef{padding:0 3px 0 8px}.dcs-a-dcs-ld-dcs-sb{padding-left:3px}.dcs-a-dcs-ld-dcs-ye{position:absolute;right:20px}.dcs-a-dcs-ld-dcs-uf{background-color:#c1d9ff;border:0;color:#c1d9ff;height:1px;margin:10px 0 10px 0}.dcs-a-dcs-ib .dcs-me-dcs-hb-dcs-ib{display:none!important}.dcs-gb-dcs-hb-dcs-ib{display:none}.dcs-a-dcs-ib .dcs-gb-dcs-hb-dcs-ib{display:inline-block!important}.dcs-a-dcs-rb-dcs-ie{border:1px solid rgba(0,0,0,0.2)}.dcs-a-dcs-rb-dcs-gf{-webkit-transition:all 270ms ease-out;-moz-transition:all 270ms ease-out;-o-transition:all 270ms ease-out;transition:all 270ms ease-out;-webkit-transform:scale(0.3);-moz-transform:scale(0.3);-o-transform:scale(0.3);transform:scale(0.3);-webkit-transform-origin:center top;-moz-transform-origin:center top;-o-transform-origin:center top;transform-origin:center top;opacity:0.3}#docos-shadow{background:#000;background:rgba(0,0,0,0.7);color:#fff;position:absolute;z-index:700;left:0;top:0}#docos-shadow,.dcs-a-dcs-v-dcs-w{height:100%;width:100%}#docos-shadow-description{font-weight:bold}#docos-shadow-confirm,#docos-shadow-delete{margin:2px 7px}.dcs-a-dcs-x .dcs-a-dcs-c-dcs-gc{padding-bottom:6px}.dcs-a-dcs-x .dcs-a-dcs-c-dcs-se{margin:0 4px 0 0}.dcs-a-dcs-x .dcs-a-dcs-c-dcs-fb{background:none}.dcs-a-dcs-g{border-top:1px solid #e8e8e8;font-family:Arial,sans-serif;font-size:12px;padding:18px 0 7px 0;position:relative;outline:none;zoom:1}.dcs-a-dcs-g:last-child{padding-bottom:0}.dcs-a-dcs-g:last-child .dcs-a-dcs-g-dcs-le{padding-bottom:0}.dcs-a-dcs-g .dcs-a-dcs-vb-dcs-eg{min-height:48px}.dcs-a-dcs-jf{margin-right:12px;min-height:51px;padding:0 6px;position:relative;top:-3px}.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-jf{background-color:#fffbe1}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-jf{background-color:#f6f6f6}.dcs-a-dcs-g-dcs-t{margin-left:60px;position:relative}.dcs-a-dcs-g-dcs-ic{font-weight:bold}.dcs-a-dcs-g-dcs-bb{color:#333;word-wrap:break-word;top:-7px;zoom:1}.dcs-a-dcs-g.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-g-dcs-bb{color:#999}.dcs-a-dcs-g .dcs-a-dcs-cb-dcs-rb-dcs-wc-dcs-xc{display:none;right:5px;top:-12px}.dcs-a-dcs-g.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-cb-dcs-rb-dcs-wc-dcs-xc{display:block}.dcs-a-dcs-g-dcs-hd,.dcs-a-dcs-g-dcs-ue-dcs-ve{font-size:11px;color:#999;padding:0}.dcs-a-dcs-g-dcs-hd,.dcs-a-dcs-g-dcs-kd-dcs-sb{right:2px}.dcs-a-dcs-g-dcs-r{color:#ccc;font-size:12px;line-height:100%;padding:0 2px}.dcs-a-dcs-g-dcs-le{padding:4px 0}.dcs-a-dcs-g-dcs-hd:hover{text-decoration:underline;cursor:pointer}.dcs-a-dcs-g-dcs-c-dcs-d{padding-right:6px;margin-left:30px}.dcs-a-dcs-g-dcs-c-dcs-d .dcs-a-dcs-c-dcs-id{background-color:#fff;border:1px solid #c9d4ec;height:23px;font-size:12px}.dcs-a-dcs-g-dcs-c-dcs-d.dcs-a-dcs-c-dcs-mc .dcs-a-dcs-c-dcs-id{background-color:#fff}.dcs-a-dcs-g-dcs-h-dcs-d .dcs-a-dcs-c-dcs-id{height:36px}.dcs-a-dcs-g-dcs-gd,.dcs-a-dcs-g-dcs-vc{margin:4px 12px 3px 0}.dcs-a-dcs-g-dcs-gd{background-color:#eff2f9;-moz-border-radius:0 0 6px 6px;-webkit-border-radius:0 0 6px 6px;border-radius:0 0 6px 6px;padding:6px 0 2px 6px;position:relative;zoom:1}.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-g-dcs-gd{background-color:#f6f6f6}.dcs-a-dcs-g-dcs-td{position:absolute;right:0;top:0}.dcs-a-dcs-g.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-g-dcs-td{right:33px}.dcs-a-dcs-g-dcs-lb{background-color:#fe8;bottom:0;left:0;padding:2px 0;position:absolute;width:100%}.dcs-a-dcs-lb-dcs-yd{font-weight:bold;margin:0 6px;padding:2px 0}.dcs-a-dcs-g .dcs-a-dcs-dc-dcs-mb{position:absolute;right:-12px;top:0}.dcs-a-dcs-g-dcs-kd-dcs-sb{display:inline}.dcs-a-dcs-g-dcs-kd-dcs-sb>.dcs-a-dcs-vb-dcs-kd{font-size:11px;color:#15c}.dcs-a-dcs-g-dcs-qd-dcs-sb>.dcs-a-dcs-vb-dcs-qd,.dcs-a-dcs-g-dcs-rb-dcs-sb>.dcs-a-dcs-vb-dcs-rb{color:#999;line-height:100%}.dcs-a-dcs-g-dcs-qd-dcs-sb>.dcs-a-dcs-vb-dcs-qd:hover,.dcs-a-dcs-g-dcs-kd-dcs-sb>.dcs-a-dcs-vb-dcs-kd:hover,.dcs-a-dcs-g-dcs-rb-dcs-sb>.dcs-a-dcs-vb-dcs-rb:hover{text-decoration:underline;cursor:pointer}.dcs-a-dcs-jf:hover .dcs-a-dcs-vb-dcs-qd,.dcs-a-dcs-jf:hover .dcs-a-dcs-vb-dcs-rb,.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-vb-dcs-qd,.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-vb-dcs-rb{color:#15c}.dcs-a-dcs-x-dcs-fe{line-height:140%;outline:none}.dcs-a-dcs-x-dcs-t{padding:0 29px 0 20px;position:relative}.dcs-a-dcs-x-dcs-y{color:#15c;cursor:pointer;font-size:12px;position:absolute;right:0;top:-3px}.dcs-a-dcs-x-dcs-y:hover{text-decoration:underline}.dcs-a-dcs-xf .dcs-a-dcs-x-dcs-y{color:#999;cursor:default}.dcs-a-dcs-xf .dcs-a-dcs-x-dcs-y:hover{text-decoration:none}.dcs-a-dcs-x-dcs-je{bottom:-10px;color:#15c;cursor:pointer;font-size:12px;padding-right:5px;padding-top:5px;position:absolute;right:5px;text-decoration:none}.dcs-a-dcs-xf .dcs-a-dcs-x-dcs-je{display:none}.dcs-a-dcs-x-dcs-nb{color:#333;padding:12px 0}.dcs-a-dcs-x-dcs-z{margin:6px 0 10px 0;position:relative;zoom:1}.dcs-a-dcs-x-dcs-z-dcs-t{margin-left:61px;position:relative;zoom:1}.dcs-a-dcs-x-dcs-ze{font-size:12px;font-weight:bold;margin-bottom:3px;top:-3px}.dcs-a-dcs-x-dcs-zd{font-size:1.2em;margin:20px 5px 2px}.dcs-a-dcs-x-dcs-c-dcs-d{top:-4px}.dcs-a-dcs-x-dcs-c-dcs-d .dcs-a-dcs-c-dcs-se{font-weight:bold}.dcs-a-dcs-x-dcs-c-dcs-d .dcs-a-dcs-c-dcs-id{font-size:12px;height:30px}.dcs-a-dcs-x .dcs-a-dcs-c-dcs-ob-dcs-pb-dcs-qb{color:#666}.dcs-a-dcs-x-dcs-qf{background-color:#dd4b39;border:1px solid #602019;border-radius:4px;color:#fff;margin:6px;padding:6px;text-align:center}.dcs-a-dcs-s{background-color:#eff2f9;color:#666;font-size:12px;padding:6px 6px 0 6px;position:relative;margin-bottom:3px;min-height:24px}.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-s{background-color:#f6f6f6}.dcs-a-dcs-s-dcs-k{left:6px}.dcs-a-dcs-s-dcs-t{padding-left:30px}.dcs-a-dcs-s-dcs-ac{color:black;font-weight:bold;left:-2px;margin:0 4px;right:-2px}.dcs-a-dcs-s-dcs-bb{color:#333;margin:0;top:-4px;width:100%;word-wrap:break-word}.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-s-dcs-bb{color:#999}.dcs-a-dcs-s-dcs-pe,.dcs-a-dcs-s-dcs-hd{position:relative;top:-3px}.dcs-a-dcs-s-dcs-pe{width:100%}.dcs-a-dcs-s-dcs-hd{color:#999;font-size:11px;white-space:pre}.dcs-a-dcs-g .dcs-a-dcs-s .dcs-a-dcs-jb-dcs-sb{display:none;top:-3px}.dcs-a-dcs-g .dcs-a-dcs-s:hover .dcs-a-dcs-jb-dcs-sb{display:inline}.dcs-a-dcs-s-dcs-h-dcs-d .dcs-a-dcs-c-dcs-id{height:23px}.dcs-a-dcs-g .dcs-a-dcs-jb-dcs-kb{border-left:1px solid #ccc;font-style:italic;padding:3px 10px 3px 10px;position:relative;zoom:1;word-wrap:break-word}.dcs-a-dcs-jb-dcs-kb-dcs-ud{font-size:11px;color:#999;margin-right:2px;padding:0}.dcs-a-dcs-jb-dcs-kb-dcs-xb{overflow:hidden;height:18px}.dcs-a-dcs-jb-dcs-kb-dcs-yb{background:#fff;padding:3px 5px 0 5px;position:absolute;right:0;top:0}.dcs-a-dcs-jb-dcs-kb-dcs-kc,.dcs-a-dcs-jb-dcs-kb-dcs-yb{color:#15c;visibility:hidden}.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-jb-dcs-kb-dcs-kc,.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-jb-dcs-kb-dcs-yb{visibility:visible}.dcs-a-dcs-jb-dcs-kb-dcs-kc{padding-left:3px}.dcs-a-dcs-vb-dcs-jd .dcs-a-dcs-jb-dcs-kb-dcs-yb{background:#fffbe1}.dcs-a-dcs-vb-dcs-jd.dcs-a-dcs-vb-dcs-wf .dcs-a-dcs-jb-dcs-kb-dcs-yb{background:#f6f6f6}.dcs-a-dcs-jb-dcs-kb-dcs-kc:hover,.dcs-a-dcs-jb-dcs-kb-dcs-yb:hover{cursor:pointer;text-decoration:underline}.dcs-a-dcs-id{margin:0;padding:2px;font-family:arial,sans-serif;outline-width:0!important;resize:none}.dcs-a-dcs-jb-dcs-zc,.dcs-a-dcs-jb-dcs-h{color:#15c;font-size:11px;margin:0 2px}.dcs-a-dcs-jb-dcs-zc:hover,.dcs-a-dcs-jb-dcs-h:hover{text-decoration:underline;cursor:pointer}.dcs-a-dcs-c-dcs-fb{margin:2px 0}.dcs-a-dcs-c-dcs-se{margin:2px 7px 2px 0}</style><script gapi_processed="true" src="FirmwareVerifiedBootCrypto_files/api.js" charset="UTF-8" type="text/javascript"></script><script src="FirmwareVerifiedBootCrypto_files/ga.js"></script></head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<script src="FirmwareVerifiedBootCrypto_files/caja.js"> </script>
<script src="FirmwareVerifiedBootCrypto_files/jot_caja.js"> </script>
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" style="height:auto;" cellspacing="0">
<tbody><tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class=""><div class="sites-header-cell-buffer-wrapper"><a href="http://sites.google.com/a/chromium.org/dev/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="FirmwareVerifiedBootCrypto_files/customLogo.png" alt="Logo" class="sites-logo "></a><h2><a href="http://sites.google.com/a/chromium.org/dev/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search"><input id="sites-searchbox-scope" name="scope" value="search-site" type="hidden"><input id="jot-ui-searchInput" name="q" size="20" aria-label="Search this site" type="text"><div id="sites-searchbox-button-set" class="goog-inline-block"><div style="-moz-user-select: none;" role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container">
</td>
</tr>
</tbody></table> 
</div> 
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellpadding="{scmCellpadding}" cellspacing="0" border="0">
<tbody><tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed"><div class="sites-embed-content sites-sidebar-nav"><ul jotid="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/chromium-projects" jotid="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/Home" jotid="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/chromium-os" jotid="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul jotid="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/system/app/pages/sitemap/hierarchy" jotid="wuid:gx:1d50c9e952c62cdc" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul jotid="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://code.google.com/policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<a dir="ltr" href="http://www.chromium.org/chromium-os">Chromium OS</a>‎ &gt; ‎<a dir="ltr" href="http://www.chromium.org/chromium-os/chromiumos-design-docs">Design Documents</a>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr">Firmware Verified Boot Crypto Specification</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" class="sites-layout-name-one-column sites-layout-hbox" cellspacing="0"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><span style="font-family:Verdana"><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Abstract"><strong>1 </strong>Abstract</a><ol class="goog-toc"><li class="goog-toc"><a href="#Design_Principles_and_Pitfalls_8677765503525734"><strong>1.1 </strong>Design principles and pitfalls</a></li><li class="goog-toc"><a href="#Background_9948604376986623_76"><strong>1.2 </strong>Background</a></li></ol></li><li class="goog-toc"><a href="#How_cryptographic_signature_ve"><strong>2 </strong>How cryptographic signature verification works</a><ol class="goog-toc"><li class="goog-toc"><a href="#Root_Keys_and_Signing_Keys_336_2005125042051077"><strong>2.1 </strong>Root keys and signing keys</a><ol class="goog-toc"><li class="goog-toc"><a href="#Preventing_Rollback_Attacks_32_9610213935375214"><strong>2.1.1 </strong>Preventing rollback attacks</a></li><li class="goog-toc"><a href="#Speed_and_bottleneck_considera"><strong>2.1.2 </strong>Speed and bottleneck considerations</a></li></ol></li><li class="goog-toc"><a href="#Putting_it_all_together_Crypto_002011277712881565"><strong>2.2 </strong>Putting it all together: Crypto Architecture</a></li><li class="goog-toc"><a href="#Kernel_level_verification"><strong>2.3 </strong>Kernel-level verification</a></li><li class="goog-toc"><a href="#Lifetime_of_the_Root_Key_7646217057481408"><strong>2.4 </strong>Lifetime of the root key</a></li><li class="goog-toc"><a href="#What_crypto_implementations_ne_4928052546456456"><strong>2.5 </strong>What crypto implementations need to be a part of the R/O firmware</a></li><li class="goog-toc"><a href="#Other_Crypto_Issues_9152098940_9233817029744387"><strong>2.6 </strong>Other considerations</a><ol class="goog-toc"><li class="goog-toc"><a href="#What_key_size_is_enough_for_th_13512184657156467"><strong>2.6.1 </strong>What key size is enough for the root key and signing key?</a></li><li class="goog-toc"><a href="#RSA_Padding_7247870247811079_9_9370813267305493"><strong>2.6.2 </strong>RSA padding&nbsp;</a></li><li class="goog-toc"><a href="#What_is_the_TPM_used_for_14809_872982325963676"><strong>2.6.3 </strong>What is the TPM used for?</a></li></ol></li><li class="goog-toc"><a href="#Functional_Tests_and_Hardware_"><strong>2.7 </strong>Functional tests and hardware qualifications&nbsp;</a></li></ol></li></ol></div></div></div></div><h3 style="font-size:12pt"><a name="TOC-Abstract"></a>Abstract</h3><font size="2">This
 document describes the cryptographic primitives and building blocks 
used for implementing verified boot in the firmware. The document is 
primarily targeted at Google Chrome OS-based devices running 
Google-signed firmware and software. Chromium OS devices may use similar
 verified boot schemes with their own (non-Google-signed) chain of 
trust. We want to emphasize this does not prevent devices based on the 
open source Chromium OS project from having their own firmware. The goal
 here is to assure customers of Google Chrome OS devices that they are 
actually running Google Chrome OS.&nbsp;</font><br><font size="2"><br></font><h3 style="font-size:12pt"><a name="Design_Principles_and_Pitfalls_8677765503525734"></a>Design principles and pitfalls</h3><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">Since
 we are in firmware land, the cost of changing the architecture after an
 implementation is high! Cost varies from "unfixable" for the boot stub 
to "need a firmware update" for the writable firmware and the algorithm 
for verifying the kernel.&nbsp;&nbsp;</font></li><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px;text-align:left"><font size="2">Choose a conservative and simple design.&nbsp;</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Have the design reviewed by experts. (Review first, implement later.)</font></li></ul><li style="margin-top:0px;margin-bottom:0px"><font size="2">Security doesn't come for free. We want to minimize the performance overhead as much as possible.</font></li><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">In
 the context of this document, the main performance concern is 
minimizing time to boot, or more specifically, the time taken to pass 
control to a trusted Chrome OS kernel.&nbsp;</font></li></ul><li style="margin-top:0px;margin-bottom:0px"><font size="2">Use well understood cryptographic building blocks instead of designing new ones.</font></li><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">Cryptography is hard to understand, even harder to get right.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Use well known and studied crypto primitives (RSA, SHA, AES, etc.) and protocols (public-key signatures).</font></li></ul></ul><br><br><h3 style="font-size:12pt"><a name="Background_9948604376986623_76"></a>Background</h3><div style="margin-top:0px;margin-bottom:0px"><font size="2">The
 firmware is the lowest level of software that runs on a system. In 
Chrome OS devices, the firmware is responsible for initializing the main
 application processor along with RAM, embedded controllers, chipsets, 
etc. In certain architectures, e.g. ARM, a separate modem processor is 
responsible for initializing the main processor. Parts of the firmware 
are&nbsp;<i>read-only&nbsp;</i>(at the lower layers). &nbsp;This code is
 baked into the firmware during production and can't be changed. The 
rest of the firmware is field upgradable. The proposed mechanisms for 
such updates are described in a separate document. At the boundary 
of&nbsp;<i>read-only</i>&nbsp;to&nbsp;<i>read-write</i>&nbsp;firmware, 
the verified boot mechanism (firmware-land) kicks in. It is responsible 
for verifying that the next piece of code is signed by Google for Google
 Chrome OS devices. The goal here is to provide a boot path to end users
 which provides assurances<b>&nbsp;</b>that they are running known good code.&nbsp;</font></div><font size="2"><b><br></b></font><div style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Important note:</b>&nbsp;To reemphasize the point made in the&nbsp;<a href="http://www.chromium.org/chromium-os/chromiumos-design-docs/verified-boot" title="Verified Boot">Verified Boot</a>&nbsp;design document, we are&nbsp;<b>not&nbsp;</b><i>preventing&nbsp;</i>users from running&nbsp;<i>any</i>&nbsp;operating
 system they please, only to provide a mechanism that guarantees that a 
Chrome OS device is running the authentic Google Chrome OS.&nbsp;</font></div><font size="2"><br></font><h2 style="font-size:14pt"><a name="How_cryptographic_signature_ve"></a><b>How cryptographic signature verification works</b></h2><div style="margin-top:0px;margin-bottom:0px"><font size="2">This
 section presents a small primer on how signature verification is 
designed to work in our context. We use public-key cryptography: each 
key is actually a keypair with public and private key components. Data 
encrypted by the private key can be decrypted by the public key and vice
 versa. In all cases, the private key component is known only to Google.
 The public key is used by the firmware for performing the verification.
 A simple implementation would be for Google to encrypt an entire r/w 
firmware component with the private key, and for the firmware to use the
 corresponding pre-baked public key to decrypt the firmware and continue
 execution (if decryption is successful). However, public-key 
cryptography is sloooow, and moreover, we are not interested in the 
confidentiality of the firmware component, only that any code we execute
 in the verified boot path is authenticated. Therefore, we use the 
concept of cryptographic signatures. Public-key signatures combine 
message digests (such as SHA-1) with public-key cryptography.&nbsp;</font></div><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">A message digest of a message&nbsp;<i>m</i>&nbsp;maps the message to a fixed size hash value&nbsp;<i>H(m)</i>. A cryptographic message digest has two essential properties:</font></div><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">Collision resistance: Two different messages are highly unlikely to map to the same hash value.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Irreversibility: Given a hash value, it's computationally infeasible to generate a message&nbsp;<i>m</i>&nbsp;which hashes to that value. &nbsp;</font></li></ul><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">Here are the steps for firmware verification:</font></div><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">For a firmware component blob&nbsp;<i>F</i>, Google generates a signature&nbsp;<i>S(F)&nbsp;</i>=&nbsp;<i>RSA_privatekey(H(F))</i>, where&nbsp;<i>H</i>&nbsp;is the message digest function.&nbsp;</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">The firmware verification routine takes&nbsp;<i>F</i>&nbsp;and&nbsp;<i>S(F)</i>&nbsp;as input, computes&nbsp;<i>H(F)</i>&nbsp;and verifies that&nbsp;<i>H(F)</i>&nbsp;==&nbsp;<i>RSA_publickey(S(F)).</i></font></li></ol><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">The security of the above scheme depends on two key factors:&nbsp;</font></div><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">The firmware verification routine uses the&nbsp;<i>correct&nbsp;</i>public key on the attached signature to get the expected hash value.&nbsp;</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Only Google can generate a signature that successfully verifies using the "correct" public key.</font></li></ul><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">We
 ensure that the correct public key is used by putting the public key in
 the read only part of the firmware. It doesn't matter if it can be read
 by an attacker, since it only allows for verifying an existing 
signature. We ensure that the signature is generated by Google by 
keeping the private key known only to Google, so only Google can 
generate a valid signature on a blob of data.&nbsp;</font></div><font size="2"><br></font>Here's
 a table listing various hashing and signature verification algorithms, 
including their speed as measured by invoking "openssl speed" on a 
typical netbook.<br><br><table style="font-size:1em;line-height:inherit;border-collapse:collapse" cellpadding="3" cellspacing="0" width="100%" border="1" bordercolor="#000000"><tbody><tr style="text-align:left"><td width="33%"><b>Algorithm</b></td><td width="33%"><b>Speed</b></td><td width="33%"><b>Note</b></td></tr><tr style="text-align:left"><td width="33%">RSA-1024</td><td width="33%">0.4ms/verification</td><td width="33%">NIST recommends not to be used after 2010</td></tr><tr style="text-align:left"><td width="33%">RSA-2048<br></td><td width="33%">1.28ms/verification</td><td width="33%">NIST recommended for use after 2010</td></tr><tr style="text-align:left"><td width="33%">RSA-4096</td><td width="33%">4.5ms/verification</td><td width="33%">NIST recommended for use after 2010</td></tr><tr style="text-align:left"><td width="33%"><font color="#999999">MD5</font></td><td width="33%"><font color="#999999">256MB/s*</font></td><td width="33%"><font color="#999999">Considered Unsafe</font></td></tr><tr style="text-align:left"><td width="33%">SHA-1</td><td width="33%">111MB/s*</td><td width="33%">Recent attacks suggest its collision resistance is lesser than previously thought (80-bits)</td></tr><tr style="text-align:left"><td width="33%">SHA-256</td><td width="33%">26MB/s*</td><td width="33%">NIST recommended for use after 2010</td></tr><tr style="text-align:left"><td width="33%">SHA-512</td><td width="33%">27MB/s*</td><td width="33%"><br></td></tr></tbody></table>* - 8192 byte blocks.<br><br><h3 style="font-size:12pt"><a name="Root_Keys_and_Signing_Keys_336_2005125042051077"></a>Root keys and signing keys</h3>Since
 signature verification comes with an additional overhead, we can't 
simply choose to use the strongest available verification algorithm for 
the whole verified boot process. However, we need to start with a strong
 enough algorithm to protect Chrome OS devices for their expected 
lifetime. For long-term use, NIST recommends using&nbsp;<i>at least</i>&nbsp;<a href="http://csrc.nist.gov/publications/drafts/800-57-part3/Draft_SP800-57-Part3_Recommendationforkeymanagement.pdf" target="_blank" title="RSA-2048 and SHA-256">RSA-2048 and SHA-256</a>.
 Therefore, we plan on using a combination of a stronger root key and 
weaker signing keys. We will use a strongest available algorithm (within
 practical speed constraints) to sign an initial key. Subsequent stages 
of the verified boot will use the weaker (but faster) algorithms for 
verification.<br><br><div style="margin-top:0px;margin-bottom:0px">If 
one of the weaker algorithms or signing keys used for verification of 
these subsequent stages is cracked/broken, a new firmware or software 
update can be issued that uses a different signing key and/or a stronger
 algorithm.<br><br><h4 style="font-size:10pt"><a name="Preventing_Rollback_Attacks_32_9610213935375214"></a><b>Preventing rollback attacks</b></h4></div><div style="margin-top:0px;margin-bottom:0px">To
 prevent rollback attacks, where an attacker may try to to update a 
Google Chrome OS device with an older signed firmware that has a known 
vulnerability, each signing key has a strictly increasing 
associated&nbsp;<b>Key Version#</b>. The read-only firmware writes the highest&nbsp;<b>Key Version#</b>&nbsp;so
 far into an NVRAM location, in the TPM chip. This NVRAM location is 
lockable, such that only the read-only firmware can write to it, and 
can't be overwritten by any other firmware component or the operating 
system. During the verified boot process, the read-only firmware refuses
 to pass control to a signed firmware block that uses a signing key with
 an index smaller than the highest seen so far. In addition, since we 
have two firmware copies, this index can be updated whenever min(Key#A, 
Key#B) changes. This allows the device to survive a failed firmware 
update. On successful boot with the new firmware, the previous copy of 
the firmware is overwritten by the new one, the highest signing key 
index is updated, and any further rollbacks are prevented.</div><br><div style="margin-top:0px;margin-bottom:0px">In addition to the&nbsp;<b>Key Version#</b>&nbsp;associated with each key, each firmware update has an associated&nbsp;<b>Firmware Version#</b>.
 The R/O firmware also keeps track of this in a non-volatile location 
similar to the Key Version# to prevent rollbacks to an older R/W 
firmware. Note that these two numbers serve different purposes:</div><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">Key
 Version# prevents key rollbacks (use of an older invalidated signing 
key that might have been compromised to sign a firmware)</li><li style="margin-top:0px;margin-bottom:0px">Firmware Version# prevents firmware rollbacks (use of an older signed firmware update that might have known vulnerabilities)</li></ul><br><h4 style="font-size:10pt"><a name="Speed_and_bottleneck_considera"></a><b>Speed and bottleneck considerations</b></h4>Although
 public key signature verification is an expensive operation, we expect 
the main bottleneck to be hash computation of blocks of data that need 
to be verified. In addition, verification will likely happen just a few 
times for each final hash value that is computed. Given these tradeoffs,
 it's likely that we'll still be able to use the stronger verification 
algorithm (for example, RSA-2048 below) once we switch to using the 
signing key for verification, but we'll need to switch to a weaker 
hashing algorithm (SHA-1), that is, start with RSA-4096+SHA-512, then 
switch to RSA-2048+SHA-1. This tradeoff can be revisited and analyzed in
 more detail once we have some hard numbers from an actual verified boot
 implementation.<br><h3 style="font-size:12pt"><a name="Putting_it_all_together_Crypto_002011277712881565"></a>Putting it all together: Crypto Architecture</h3><br><div style="margin-top:0px;margin-bottom:0px;text-align:left"><div style="margin-top:0px;margin-bottom:0px;text-align:left"><img src="FirmwareVerifiedBootCrypto_File.png" style="height:521.517px;width:1024px"></div><br></div><br><br><font size="2">For&nbsp;<b>Header H:</b></font><br><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Length</b>, is a fixed-width field and equals the length of H</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Algorithm</b>&nbsp;is
 a fixed-width field integer that specifies the key size and hashing 
algorithm to use for verifying signatures using the signing key.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Signing Key</b>&nbsp;is the signing key used for the rest of the firmware.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Key Version#</b>&nbsp;is the rollback index associated with the&nbsp;<b>Signing Key</b></font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Crypto Hash</b>&nbsp;is a fixed-width field that contains the cryptographic hash of the rest of the header&nbsp;<b>H(Len || Algorithm || Signing Key || Key Version#).</b></font></li></ul><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">Signature&nbsp;<b>S_root = RSA_Sign(<font color="#0000FF">Root Key</font>, H)</b></font></div><font size="2"><font size="2"><br></font>The signature for the R/W firmware is split into two:</font><br><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">Signature&nbsp;<b>S_signing#1</b>&nbsp;=&nbsp;<b>RSA_Sign</b>(<b><font color="#0000FF">Signing Key</font></b>,&nbsp;<b>Firmware Version# | Len | Preamble</b>)</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Signature&nbsp;<b>S_signing#2</b>&nbsp;=&nbsp;<b>RSA_Sign</b>(<font color="#0000FF"><b>Signing Key</b>,</font>&nbsp;<b>R/W Firmware Data</b>).</font></li></ul><font size="2"><br></font><font size="2">This signature helps in verifying the length field and the Firmware rollback early in the verification process.&nbsp;<br></font><font size="2"><font size="2"><br></font>For rollback protection, we have a pair of indices: the&nbsp;<b>Key Version# (K#)</b>&nbsp;and the&nbsp;<b>Firmware Version# (F#)</b>. K# is updated whenever the signing key is changed—either if it's past its lifetime (<i>Y</i>&nbsp;months)
 or if it has been compromised. F# is incremented with each update. 
Logically, the combination of K# and F# uniquely identifies the version 
of an update. The update process will&nbsp;<b>refuse to update if either of the following conditions is TRUE</b>:&nbsp;</font><br><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">K# == &nbsp;stored K#, but F# &nbsp;&lt; stored F#</li><li style="margin-top:0px;margin-bottom:0px">K# &lt; stored K#</li></ol><div style="margin-top:0px;margin-bottom:0px"><br>Having
 separate key version and firmware version rollback prevention indices 
allows for generating new firmware updates without the need to generate a
 new signing key each time (which in turn requires getting the root key 
out of secure storage). This way, firmware updates are protected against
 rollbacks even if the signing key stays the same.<br><b><br></b><p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px">The steps performed by the read-only firmware are as follows:</p><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">Verify the signing key signature is valid<br>- If RSA_Verify(<b><font color="#0000FF">Root Key</font></b>,<b>&nbsp;H</b>) fails, Go to&nbsp;</font><font size="2"><b>Step 7&nbsp;</b>(Failure).<br></font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Verify that this is not a&nbsp;<b>key rollback&nbsp;</b><br>- If K# &lt; Stored K#, go to&nbsp;</font><font size="2"><b>Step 7&nbsp;</b>(Failure).<b>&nbsp;</b></font><font size="2"><br>- else, Stored K# = K#, lock Stored Key# to prevent write access</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Verify that this is not a&nbsp;<b>firmware rollback&nbsp;</b><br><font size="2"><b>-&nbsp;</b>If F# &lt; Stored F#, go to&nbsp;</font><font size="2"><b>Step 7</b> &nbsp;(Failure).<br>- else, Stored F# = F#, lock Stored F# to prevent write access</font></font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Determine signing key algorithm to use from "Algorithm." For now, let's assume we decide to go with RSA-1024 and SHA-1.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">From here on, the rest of the verification is performed using the signing key and algorithm<br><font size="2">- For example, To verify a firmware blob F, do RSA_Verify(<font color="#0000FF"><b>Signing Key</b></font>,&nbsp;<b>F</b>). If NOT, Go to&nbsp;</font><font size="2"><b>Step 7. &nbsp;</b></font></font></li><li style="margin-top:0px;margin-bottom:0px"><font color="#0000ff"><font size="2">Success</font></font><font size="2">&nbsp;- Continue with&nbsp;<b>kernel level verification</b></font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><font color="#cc0000">Failure -</font>If this is firmware-A, repeat above steps with firmware-B. If firmware-B is bad,&nbsp;<font color="#FF0000">go to recovery!!</font></font></li></ol><br><font size="2">Note
 that, for both the root key and signing key, only the public part of 
the key is exposed. This ensures that only Google can generate S_root 
and S_signing.&nbsp;<br><br></font><h3 style="font-size:12pt"><a name="Kernel_level_verification"></a><b>Kernel-level verification</b></h3><p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px">Once
 the R/W firmware has been verified, the next step is for the R/W 
firmware to verify the kernel before passing control to it. There are a 
few possible options here:</p><br><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">Use a different signing key just for kernel signing. This key must be verified by the R/W firmware signing key.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Use the R/W firmware signing key for verifying the kernel.<br><br></font></li></ol><p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px">The
 main disadvantage of option 1 is the extra verification step required 
for verifying the kernel signing key. In addition, a separate rollback 
key index must stored for the kernel signing key.</p><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">The main disadvantage of option 2<b>&nbsp;</b>is that now any kernel update must be accompanied by a firmware update with a new signing key (for preventing rollback).&nbsp;</font></div><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">As
 a firmware update is much more time consuming and disruptive than a 
kernel update, we chose option 1 (use a different signing key just for 
kernel signing).</font></div><font size="2"><font size="2"><br></font>In
 addition, the kernel is stored on the disk and it needs to be retrieved
 by parsing the partition table. Currently, there is no cryptographic 
verification of the partition table. However, the firmware code does a 
strict checking of the partition table (e.g. ensuring there are no 
overlapping partitions) and outright rejects partition tables that do 
not look right.&nbsp;</font></div><div style="margin-top:0px;margin-bottom:0px"><font size="2"><br></font></div><div style="margin-top:0px;margin-bottom:0px"><font size="2">Note also that since this happens in the R/W firmware, the verification mechanism can change over time and with autoupdates.</font></div><font size="2"><br></font><h3 style="font-size:12pt"><a name="Lifetime_of_the_Root_Key_7646217057481408"></a>Lifetime of the root key</h3><div style="margin-top:0px;margin-bottom:0px">Since
 the root key is baked into the read-only firmware at manufacture, it 
can't be changed once a Chrome OS device leaves the factory. Since any 
update to this key requires changes during manufacture, these will be 
changed once every four years. Since the root keys have a much larger 
lifetime than the signing keys, they will be of higher strength (4096 
bit RSA keys or higher). The signing key to use for pushing an update to
 a device can be determined via the SKU. Newer SKUs will use the newer 
root key chain of trust.&nbsp;</div><h3 style="font-size:12pt"><a name="What_crypto_implementations_ne_4928052546456456"></a>What crypto implementations need to be a part of the R/O firmware</h3><div style="margin-top:0px;margin-bottom:0px"><font size="2">Ideally,
 due to firmware size limitations, goals for minimal complexity, and the
 inability to update in the field, we'd like to limit the functionality 
implemented in the the read-only firmware to the bare essentials.&nbsp;</font></div><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">At the very least, the read-only firmware needs to implement the following:&nbsp;<br><br></font></div><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">RSA Signature Verification (for combinations of various 1024-8192 bit key sizes and SHA-1/256/512 message digest algorithms)</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">SHA-1/256/512 Hashing</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">A way to write and lock a portion of the NVRAM such that it can't be written to by any other component</font></li></ol><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">Items 1 and 2 are required to verify the signing key. Item 3 is required to&nbsp;<a href="https://docs.google.com/a/google.com/Doc?docid=0AWwzXTHj7UwzZGhtOHZwNHJfMTNnaHc1cHNmNA&amp;hl=en#Preventing_Rollback_Attacks_32" title="prevent key rollback attacks">prevent rollback attacks</a>.&nbsp;</font></div><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">The weaker (relatively) crypto algorithms used by the signing keys&nbsp;<b>may&nbsp;</b>be implemented in the R/W firmware. However, there are risks to consider here:<br><br></font></div><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2">The
 algorithm implementations on the R/W firmware also needs to be verified
 by the R/O firmware, a task that results in additional overhead.&nbsp;</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2">Additional
 complexity is required in the R/O firmware for memory mapping these 
algorithms for use by the rest of the firmware.&nbsp;</font></li></ol><font size="2"><br></font>To
 avoid the additional complexity involved in having the algorithm 
implementations in the R/W firmware, we currently plan on having the R/O
 firmware implement all of SHA-1/256/512 and RSA-1024/2048/4096/8192. 
Although R/O firmware size may be a constraint, the variants within each
 class of algorithms (SHA-256 and SHA-512, for example) are similar, and
 there should be some opportunity for code reuse between them.<br><br><h3 style="font-size:12pt"><a name="Other_Crypto_Issues_9152098940_9233817029744387"></a><font size="3">Other considerations</font></h3><h4 style="font-size:10pt"><a name="What_key_size_is_enough_for_th_13512184657156467"></a>What key size is enough for the root key and signing key?</h4><div style="margin-top:0px;margin-bottom:0px">NIST&nbsp;<a href="http://csrc.nist.gov/publications/drafts/800-57-part3/Draft_SP800-57-Part3_Recommendationforkeymanagement.pdf" title="recommends">recommends</a>&nbsp;the
 use of RSA 2048/SHA-256 or higher as the signature algorithm for use 
after 12/31/2010. Our plan is to use a 8192-bit RSA key with SHA-512 for
 the root key signatures.</div><br>The security of RSA derives from the 
computational difficulty of factoring very large numbers into its prime 
factors. The best known current algorithm for factoring large numbers is
 the Number Field Sieve (NFS). The runtime of NFS scales as e<sup><i>c</i>&nbsp;<i>n</i>^1/3 (log</sup><sub>2</sub><sup>&nbsp;<i>n</i>)^2/3</sup>, where&nbsp;<i>n</i>&nbsp;is the size of the number in bits and&nbsp;<i>c</i>&nbsp;is typically 1.5-2.<br><br><div style="margin-top:0px;margin-bottom:0px">For
 the root key, we plan to use a 8192-bit RSA key. Note that, based on 
the runtime scaling of the Number Field Sieve, it takes at least 
1.429206 x 10<sup>24&nbsp;</sup>&nbsp;more computational effort to 
factor a 4096-bit number than a 1024-bit number. As a reference, the 
general-purpose factoring record is for the 664-bit RSA200 number which 
took the equivalent of 55 2.2GHz Opteron CPU years for the sieving step 
of NFS and an additional 3 months on an 80 2.2GHz Opteron CPU cluster 
for the matrix steps.</div><br><div style="margin-top:0px;margin-bottom:0px">For
 signing keys, we have considerable more flexibility, since the key size
 or the keys themselves can be changed with future system update. Since 
these keys will change/rotate often, we plan to use 1024-bit RSA keys 
which provides a good speed/performance trade-off.</div><div style="margin-top:0px;margin-bottom:0px">&nbsp;<br><h4 style="font-size:10pt"><a name="RSA_Padding_7247870247811079_9_9370813267305493"></a>RSA padding&nbsp;</h4>RSA
 operations during signature operations are not directly performed on 
the raw cryptographic hashes but rather on a padded/extended version of 
the cryptographic hash. We intend to use the standard padding/extension 
function for this. There are two padding schemes specified by PKCS#1 
v2.1 standard - PKCS1.5 and PSS. Although PKCS#1 recommends phasing out 
PKCS1.5 (certain attacks were discovered against faulty implementations)
 in favor of PSS, PSS is more complex to implement. PSS requires the use
 of a PRNG. So if PSS padding is used, a crypto-grade PRNG will also 
need to be implemented as part of the read-only firmware. Currently, we 
plan on using PKCS1.5 padding since its implementation is much simpler.<br><b><br></b><h4 style="font-size:10pt"><a name="What_is_the_TPM_used_for_14809_872982325963676"></a><b><b>What is the TPM used for?</b></b></h4><div style="margin-top:0px;margin-bottom:0px">For
 verified boot, we do not use the TPM for performing cryptographic 
operations, since TPM chips are not necessarily crypto-accelerator 
devices, and there is no speed advantage. We use the TPM as secure 
non-volatile storage for preventing key rollback attacks. The TCG TPM 
standard (v1.2 rev103) includes two mechanisms that we may use for 
storing monotonically increasing integers in a runtime, tamper-resistant
 fashion:&nbsp;<br><br></div><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">NVRAM regions that may be locked and written to prior to TPM ownership assertion</li><li style="margin-top:0px;margin-bottom:0px">Monotonically increasing counters</li></ul><br><div style="margin-top:0px;margin-bottom:0px">We
 use NVRAM regions in the TPM and write the counters to that space. 
&nbsp;This area is only writable at firmware read-only boot time and 
during recovery mode.</div><br><h3 style="font-size:12pt"><a name="Functional_Tests_and_Hardware_"></a><b>Functional tests and hardware qualifications&nbsp;</b></h3><div style="margin-top:0px;margin-bottom:0px"><font size="2">For
 firmware vendors, we have a suite of functional tests to test their 
implementations. This includes testing crypto blocks like RSA, SHA, as 
well as crypto primitives like signature checking.&nbsp;</font></div><font size="2"><br></font><div style="margin-top:0px;margin-bottom:0px"><font size="2">For hardware qualification tests, here are examples of tests we use:</font></div><font size="2"><br></font><ol style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Root Key Verification Test:</b>&nbsp;Provide firmware where the signing key cannot be verified by using the root key (S_root is invalid).&nbsp;<br><b>Expected Output:</b>&nbsp;Device should refuse to use the firmware, jump to Recovery.</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Rollback Prevention Test:</b>&nbsp;Provide firmware where the signing key# is less or equal to S_high.<br><b>Expected Output:</b>&nbsp;Device should refuse to use old firmware, jump to Recovery.&nbsp;</font></li><li style="margin-top:0px;margin-bottom:0px"><font size="2"><b>Signing Key Verification Test:</b>&nbsp;Provide firmware where the verification of F using the signing key fails (S_signing is invalid).<br><b>Expected Output:&nbsp;</b>Device should refuse to use the firmware, jump to Recovery.</font></li></ol><br></div><div style="margin-top:0px;margin-bottom:0px">More details can be found in the documentation for the Semi-automated Firmware Testing Framework (<a href="http://www.chromium.org/for-testers/saft">SAFT</a>).</div><br></span></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div dir="ltr" style="text-align: left;" id="sites-comment-docos-pane" class="sites-comment-docos-pane"><div tabindex="0" class="dcs-a dcs-a-dcs-x-dcs-fe dcs-a-dcs-ib"><div class="dcs-a-dcs-x-dcs-t"><div class="dcs-a-dcs-x-dcs-z dcs-me-dcs-hb-dcs-ib"><img data-userid="ANONYMOUS_105250506097979753968" src="FirmwareVerifiedBootCrypto_files/silhouette96.png" id="dcs-img-0" class="dcs-a-dcs-k g-hovercard" height="48" width="48"><div class="dcs-a-dcs-x-dcs-z-dcs-t"><div id="___hovercard_0" data-userid="ANONYMOUS_105250506097979753968" class="dcs-a-dcs-x-dcs-ze dcs-n-dcs-mf-dcs-nf g-hovercard">Anonymous</div><div class="dcs-a-dcs-c dcs-a-dcs-x-dcs-c-dcs-d"><textarea maxlength="2048" aria-haspopup="true" class="dcs-a-dcs-c-dcs-id" aria-label="Comment draft" x-webkit-speech="" speech="">Add a comment</textarea><div class="dcs-a-dcs-c-dcs-p-dcs-mb"></div><div class="dcs-a-dcs-c-dcs-p-dcs-q"></div><div class="dcs-a-dcs-c-dcs-ob-dcs-pb-dcs-qb" style="display: none">Your +mention will add people to this post and send an email.</div><div class="dcs-a-dcs-c-dcs-gc"><div style="-moz-user-select: none;" role="button" class="dcs-n-dcs-mf-dcs-nf dcs-i-dcs-tb dcs-i-dcs-tb-dcs-ub dcs-a-dcs-c-dcs-se" tabindex="0" title="Post comment"><span class="dcs-a-dcs-c-dcs-gc-dcs-se">Comment</span></div><div style="-moz-user-select: none;" role="button" class="dcs-n-dcs-mf-dcs-nf dcs-i-dcs-tb dcs-i-dcs-tb-dcs-pd dcs-a-dcs-c-dcs-fb" tabindex="0" title="Discard comment">Cancel</div></div></div></div></div><div class="dcs-a-dcs-x-dcs-nb dcs-gb-dcs-hb-dcs-ib dcs-n-dcs-mf-dcs-nf">You have no permission to add comments.</div><div class="dcs-a-dcs-ib dcs-a"></div></div><div></div></div></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</tbody></table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/a/chromium.org/dev/chromium-os/chromiumos-design-docs/verified-boot-crypto">Sign in</a>|<a class="sites-system-link" href="http://www.chromium.org/system/app/pages/reportAbuse" target="_blank">Report Abuse</a>|<a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a>|<a class="sites-system-link" href="http://www.chromium.org/system/app/pages/removeAccess" target="_blank">Remove Access</a>|<span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com/">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>

<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="FirmwareVerifiedBootCrypto_files/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
  if (webspace.editorResources['text']) {
    //<![CDATA[
webspace.editorResources['text'].unshift('/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-left');
webspace.editorResources['text'].unshift('/_/rsrc/1364510364000/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css');
//]]>

  }
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
    
        sites.core.Analytics.createTracker();
        sites.core.Analytics.trackPageview();
      
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9H0J7-DZz03xj1dltXWKkeBPoiF9HoxU-3-vV2JiTzPzZwleDcaKJRINfIHyvwVyp4qjid1sQ96KnvXuA5tcqdC5myxiXCPH9uVA6bmywcpMJPHDY/api/js?anon=true', true, true,
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type;
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
 //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>

<script type="text/javascript">
              sites.util.Plus.go('sites-chrome-main');
            </script>
<div id="server-timer-div" style="display:none"> </div>
<script>
          window.jstiming.load.tick('render');
        </script>


<div style="display: none;"><iframe src="FirmwareVerifiedBootCrypto_files/xpc.html" style="height: 100%; width: 100%;" id="xpcpeeriwy6" name="xpcpeeriwy6"></iframe></div></body></html>
